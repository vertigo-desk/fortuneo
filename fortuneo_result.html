<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <title>Fortuneo</title>
        <script type="text/javascript" src="../d3/d3.js"></script>
    </head>
    <body>
        <script type="text/javascript">

// defintion du canvas
var w=500;
var h=300;
var barPadding=1;


var svg = d3.select("body")
.append("svg")
.attr("width", w)
.attr("height", h);


// initialisation du dataset
d3.csv("result.csv", function(dataset) {
  dataset.forEach(function(course) {
    course.nbcoureurs = +course.nbcoureurs;
  })

  // elements rect
  var elts = svg.selectAll("rect")
  .data(dataset)
  .enter();

  //bar par epreuve
  elts.append("rect")
  .attr("x", function(d, i) {
    return i * (w / dataset.length);
  })
  .attr("y", function(d,i) {
      return h-dataset[i].nbcoureurs;
  })
  .attr("width", w / dataset.length -1)
  .attr("height", function(d, i) {
      return dataset[i].nbcoureurs;
  })
  .attr("fill", function(d) {
    return "rgb(190, 190, 190)";
  })

  // foreach coureur
  d3.keys(dataset[1]).forEach(function(key,index) {
    console.log(key)

    if (index >= 2) {
     //bar par coureur
      elts.append("rect")
      .attr("x", function(d, i) {
        return i * (w / dataset.length);
      })
      .attr("y", function(d,i) {

        return h-dataset[i][key];
      })
      .attr("width", w / dataset.length -1)
      .attr("height", function(d) {
        return 1;
      })
      .attr("fill", function(d) {
        return "rgb(20, 150, 20)";
      })

    }
  })
  
 
})

       </script>
    </body>
</html>