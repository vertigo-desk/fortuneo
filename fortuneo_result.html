<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <title>Fortuneo</title>
        <script type="text/javascript" src="../d3/d3.js"></script>
    </head>
    <body>
        <script type="text/javascript">

// defintion du canvas
var w=500;
var h=300;
var barPadding=1;


var svg = d3.select("body")
.append("svg")
.attr("width", w)
.attr("height", h);


// initialisation du dataset
d3.csv("result.csv", function(dataset) {
    dataset.forEach(function(course) {
        course.nb_coureurs = +course.nb_coureurs;
    })
    console.log(dataset[0])

    // elements rect
  var elts = svg.selectAll("rect")
  .data(dataset)
  .enter();

  //bar par epreuve
  elts.append("rect")
  .attr("x", function(d, i) {
      return i * (w / dataset.length);
  })
  .attr("y", function(d,i) {
      return h-dataset[i].nb_coureurs;
  })
  .attr("width", w / dataset.length -1)
  .attr("height", function(d, i) {
      return dataset[i].nb_coureurs;
  })
  .attr("fill", function(d) {
    return "rgb(190, 190, 190)";
  });

    var coureurs = d3.keys(dataset[0])
    for (var j = 2; j <= coureurs.length-1; j++) {
        var coureur = coureurs[j]
        console.log(coureur)

        //bar par coureur
      elts.append("rect")
      .attr("x", function(d, i) {
          return i * (w / dataset.length);
      })
      .attr("y", function(d,i) {
            console.log(dataset[i].VACHON)
          return h-dataset[i].VACHON;
      })
      .attr("width", w / dataset.length -1)
      .attr("height", function(d) {
          return 1;
      })
      .attr("fill", function(d) {
        return "rgb(20, 150, 20)";
      });
    };

})

       </script>
    </body>
</html>